commands:
  01_download_ml_models:
    command: |
      set -e
      cd /var/app/staging
      echo "Downloading ML models from S3..."
      node -e "
      require('module-alias/register');
      const { downloadModelsFromS3 } = require('./dist/recommenderService/src/mlutils/downloadModel');
      downloadModelsFromS3('', process.env.DATA_BUCKET || 'cubecobra-data')
        .then(() => {
          console.log('ML models downloaded successfully');
          process.exit(0);
        })
        .catch((err) => {
          console.error('Failed to download ML models:', err);
          process.exit(1);
        });
      "
    leader_only: true
