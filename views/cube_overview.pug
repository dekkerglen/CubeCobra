extends layout

block content
  h5
    nav(aria-label='breadcrumb')
      ol.breadcrumb
        li.breadcrumb-item
          a(href='/user/view/'+owner style='color: #218937;') #{owner}
        li.breadcrumb-item.active(aria-current='page')= cube.name


  ul.nav.nav-tabs.nav-fill.nav-justified
      li.nav-item
        a.nav-link.active(href='/cube/overview/'+cube._id) Overview
      li.nav-item
        a.nav-link(href='/cube/list/'+cube._id) List
      li.nav-item
        a.nav-link(href='/cube/playtest/'+cube._id) Playtest
      li.nav-item
        a.nav-link(href='/cube/analysis/'+cube._id) Analysis
      li.nav-item
        a.nav-link(href='/cube/blog/'+cube._id) Blog
  .container
    br
    .row
      .col-md-4
        .card(style='margin: 4px;')
          img.card-img-top(src=cube.image_uri style='width: 100%;height:auto;')
          em.text-right(style='padding: 2px;') Art by: #{cube.image_artist}
          .card-body
            h3=cube.name
            em
              h6 Designed by 
                a(href='/user/view/'+owner) #{owner}  
          if user
            if user.id == cube.owner
              button.btn.btn-success(data-toggle='modal', data-target='#overviewModal') Edit Overview
              p
              button.btn.btn-danger(data-toggle='modal', data-target='#deleteModal') Delete Cube
      .col
        .card(style='margin: 4px;')
          .card-body
            h5 Description
            p=cube.description
    if post
      br
      .row
        .col
          .card(style='margin: 4px;')
            .card-body
              h5.card-title=post.title
              h6.card-subtitle.mb-2.text-muted=post.date_formatted
              if post.body
                p.card-text=post.body
              if post.html
                p.card-text !{post.html}
        br
          
  // edit overview modal
  #overviewModal.modal.fade(tabindex='-1', role='dialog', aria-labelledby='cubeModalLabel', aria-hidden='true')
    .modal-dialog(role='document')
      .modal-content
        form(method='POST', action='/cube/editoverview/'+cube._id, autocomplete='off')
          .modal-header
            h5.modal-title Edit Overview
            button.close(type='button', data-dismiss='modal', aria-label='Close')
              span(aria-hidden='true') ×
          .modal-body
              .form-group
                label.col-form-label Cube Name:
                input.form-control(name='name' type='text', value=cube.name)
                label.col-form-label Cube Image:
                .card(style="width: 12rem;")
                  img#dynamicImage(src=cube.image_uri style='width: 100%;height: auto;')
                P 
                .card
                  input.form-control#imageInput(name='imagename' type='text', value=cube.image_name)
                label.col-form-label Cube Description:
                textarea.form-control(maxlength='2500', name='description')=cube.description
              br
          .modal-footer
            input.btn.btn-success(type='submit',value='Save')
            button.btn.btn-secondary(type='button', data-dismiss='modal') Close
            
  #deleteModal.modal.fade(tabindex='-1', role='dialog', aria-labelledby='deleteModalLabel', aria-hidden='true')
    .modal-dialog(role='document')
      .modal-content
        .modal-header
          h5.modal-title Confirm Delete
          button.close(type='button', data-dismiss='modal', aria-label='Close')
            span(aria-hidden='true') ×
        .modal-body                
              P Are you sure you wish to delete this cube? This action cannot be undone.
        .modal-footer
          input.btn.btn-danger.delete-cube(type='submit',value='Delete', data-id=cube._id)
          button.btn.btn-secondary(type='button', data-dismiss='modal') Close
  script(src='/js/image_autocomplete.js')
